c(-3000, -2500, rev(blues(15)))))
blues(15)
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), greys(100)),
c(-4500, -3000, '#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'),
c(-3000, -2500, rev(blues(15))).
c(-2500,0,'#00FFFF')))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), greys(100)),
c(-4500, -3000, '#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'),
c(-3000, -2500, rev(blues(15))).
c(-2500,0,'#00FFFF')))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), greys(100)),
c(-4500, -3000, '#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'),
c(-3000, -2500, rev(blues(15))),
c(-2500,0,'#00FFFF')))
blues(15)
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), greys(100)),
c(-4500, -3000, '#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'),
c(-3000, -2500, rev(blues(15))),
c(-2500,0,'#00008B')))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), '#00008B'),
c(-4500, -3000, '#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'),
c(-3000, -2500, rev(blues(15))),
c(-2500,0,'#00008B')))
c(-4500, -3000, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff')),
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), '#00008B'),
c(-4500, -3000, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(-3000, -2500, (blues(15))),
c(-2500,0,'#00ffff')))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), '#00008B'),
c(-4500, -3000, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(-3000, -2500, (blues(15))),
c(-2500,0,'#00ffff')))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), '#000000'),
c(-4500, -3000, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(-3000, -2500, (blues(15))),
c(-2500,0,'#00ffff')))
c(min(atl), -2500, (blues(15))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), '#ffffff'),
c(-2500, 0, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(min(atl), -2500, (blues(15)))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(-1000, max(atl), '#ffffff'),
c(-2500, -1000, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(min(atl), -2500, (blues(15)))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(-1000, max(atl), '#ffffff'),
c(-2000, -1000, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(min(atl), -2000, (blues(15)))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(-1000, max(atl), '#ffffff'),
c(-1500, -1000, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(min(atl), -1500, (blues(15)))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), '#ffffff'),
c(-1500, 0, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(min(atl), -1500, (blues(15)))))
blues(15)
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), '#ffffff'),
c(-1500, 0, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(-3000, -1500, (blues(15))),
c(min(alt), -3000, '#00008B'))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), '#ffffff'),
c(-1500, 0, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(-3000, -1500, (blues(15))),
c(min(alt), -3000, '#00008B')))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), '#ffffff'),
c(-1500, 0, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(-3000, -1500, (blues(15))),
c(min(atl), -3000, '#00008B')))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), '#ffffff'),
c(-1500, 0, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(-2500, -1500, (blues(15))),
c(min(atl), -2500, '#00008B')))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), '#ffffff'),
c(-1500, 0, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(-3500, -1500, (blues(15))),
c(min(atl), -3500, '#00008B')))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), '#ffffff'),
c(-1500, 0, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(-5500, -1500, (blues(15))),
c(min(atl), -5500, '#00008B')))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), '#ffffff'),
c(-1500, 0, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(-5000, -1500, (blues(15))),
c(min(atl), -5000, '#00008B')))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), greys(15)),
c(-1500, 0, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(-5000, -1500, (blues(15))),
c(min(atl), -5000, '#00008B')))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), rev(greys(15))),
c(-1500, 0, rev(c('#ffffff','#f5ffff','#ebffff','#e0ffff','#d5ffff','#caffff','#beffff','#b2ffff','#a4ffff','#96ffff','#86ffff','#75ffff','#60ffff','#43ffff','#00ffff'))),
c(-5000, -1500, (blues(15))),
c(min(atl), -5000, '#00008B')))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), rev(greys(15))),
c(min(atl), 0, rev(greys(15)))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), rev(greys(15))),
c(min(atl), 0, (greys(15)))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), rev(greys(15))),
c(min(atl), 0, rev(greys(15)))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), rev(greys(15))),
c(-4500, 0, rev(greys(15)))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), rev(greys(15))),
c(-3500, 0, rev(greys(15)))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), rev(greys(15))),
c(-3500, -1000, rev(greys(15)))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), rev(greys(15))),
c(-4500, -1000, rev(greys(15)))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), rev(greys(15))),
c(-4500, -1500, rev(greys(15)))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), rev(greys(15))),
c(-4500, -2000, rev(greys(15)))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), rev(greys(15))),
c(-4000, -2000, rev(greys(15)))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), rev(greens(15))),
c(-4000, -2000, rev(greys(15)))))
plot(atl,
image = TRUE,
land = TRUE,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), rev(blues(15))),
c(-4000, -2000, rev(greys(15)))))
plot(atl,
image = TRUE,
land = F,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), rev(blues(15))),
c(-4000, -2000, rev(greys(15)))))
plot(atl,
image = TRUE,
land = F,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), rev(greys(15))),
c(-4000, -2000, rev(greys(15)))))
plot(atl,
image = TRUE,
land = F,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), (greys(15))),
c(-4000, -2000, rev(greys(15)))))
plot(atl,
image = TRUE,
land = F,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), (greys(15))),
c(-4000, -2500, rev(greys(15)))))
plot(atl,
image = TRUE,
land = F,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), (greys(15))),
c(-3000, -2500, rev(greys(15)))))
plot(atl,
image = TRUE,
land = F,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), (greys(15))),
c(-5000, -2500, rev(greys(15)))))
plot(atl,
image = T,
land = T,
n=1,
bpal = list(c(0, max(atl), greys(100)),
c(min(atl), 0, blues(100))))
y <- c(-12.347,-19.545,-23.878,-25.3195,-37.866,-27.967,-37.65,-42.005,6.8,6.3667,-26.1565,3.1167,-11.2489)
x <- c(65.305,65.85,69.596,70.04,49.216,63.550,50.40,87.8808,60.1667,60.517,71.4377,63.3833,66.2542)
name <- c('Dodo','Solitaire','Edmond','Kairei','Longqi','Tiancheng','Duanqiao','site 21','Daxi','Wocan','Pelagia','Tianxiu','Onnuri')
vents <- data.frame(x, y, name)
plot(atl,
image = TRUE,
land = F,
xlim = c(20, 120),
ylim = c(-60, 30),
n=1,
asp = NA,
bpal = list(c(0, max(atl), (greys(15))),
c(-5000, -2500, rev(greys(15)))))
points(vents$x, vents$y, pch = 21, col = "black",
bg = "yellow", cex = 1.3)
vents
knitr::opts_chunk$set(echo = TRUE)
# setwd("~/Desktop/codon_usage/")
setwd("./")
setwd("~/Desktop/VesicSymb_Evolution/dowstream_analyses_and_data/")
library('ggplot2')
library('gridExtra')
library(RColorBrewer)
library(dplyr)
library(tidyr)
library(grid)
require(gtable)
library('scales')
library(rsvg)
library(magick)
require('cowplot')
theme_set(theme_cowplot())
library(data.table)
recombining_genes=read.table('core_genes_with_recomb_AICc.txt')$V1
pseudogenes = read.table('./pseudogenes.txt')$V1
length(pseudogenes)
relax=read.table('./relax_results.txt',header=T,sep='\t')
relax=as.data.table(relax)
core_nopseudo=relax$gene
nrow(relax)
head(relax)
relax=subset(relax,!(gene %in% recombining_genes)) # remove genes with evidence of recombination
nrow(relax)
head(relax)
relax2<-data.table::melt(relax,id.vars=c('gene','ncodons'),
measure.vars = patterns("_k", "_pval"),
variable.name = 'comp',
value.name=c('k','pval'),
variable.factor = T)
levels(relax2$comp)<-c('SymvsFL','RuvsFL','GivsFL','GivsRu')
df_all=read.csv('codonbias_results.csv',sep='\t',row.names = 1,header=T,na.strings = '')
df_all$ispseudo<-as.numeric(df$locus_tag %in% pseudogenes)
df_all$Group<-ifelse(df_all$Genome %in% c('Bathy','SUP05'),'FL',
ifelse(df_all$Genome %in% c('V.okutanii','V.soyoae1','V.soyoae2','V.diagonalis','V.extenta','V.gigas1','V.gigas2','V.marissinica'),'Gigas','Ruthia'))
colnames(df_all)
df=df_all[,-c(14:ncol(df_all)-3)]
head(df)
subset(df, !(coregene_id %in% recombining_genes ))$coregene_id %>% unique %>% length
df_nopseudo=subset(df,ispseudo==0)
# write.table(df_nopseudo,'codonbias_results_nopseudo.txt',quote=F,row.names=F,sep='\t')
# Are k values for Givs FL smaller than for Ruvs FL? Yes
df1=subset(relax2,comp %in% c('GivsFL','RuvsFL') & pval<0.05)
df1=as.data.frame(dcast(df1, gene~comp,value.var='k'))
wilcox.test(df1$GivsFL,df1$RuvsFL,alternative = 'less') # overall
wilcox.test(df1$GivsFL,df1$RuvsFL,alternative = 'less',paired=T) # respective of each gene
colors=list(Gi='#606E96',Ru='#68C47F',FL='#F6EFA1')
bipl<-data.table::dcast(as.data.table(subset(df, coregene_id %in% core_nopseudo)), coregene_id ~ Group, value.var = 'CDC', fun=mean,subset=.(P.CDC. < 0.05 & coregene_id %in% core_nopseudo))
Bi_plot<-ggplot(bipl)+
theme_bw()+
geom_point(aes(x=FL,y=Gigas,color='2'),alpha=0.6,size=0.5)+
geom_point(aes(x=FL,y=Ruthia,color='1',alpha=1-abs(1-(Ruthia/FL))),size=0.5)+
geom_abline(slope=1,intercept = 0)+
geom_smooth(aes(x=FL,y=Ruthia,color='1'),fill='grey90',method='lm',se=T,size=0.5)+
geom_smooth(aes(x=FL,y=Gigas,color='2'),fill='grey90',method='lm',se=T,size=0.5)+
scale_alpha_continuous(range = c(0.4, 0.6))+
scale_y_continuous(limits=c(0.05,0.4))+
scale_x_continuous(limits=c(0.05,0.36))+ expand_limits(x = 0)+
xlab(label = 'CDC in Free-Living')+ylab(label= 'CDC in symbionts')+
scale_color_manual(values=c(colors$Ru,colors$Gi),labels=c('Clade II','Clade I'),name='')+
theme(
legend.text=element_text(size=8))
Bi_plot
#### Arrange plots ###
p3<-grid.arrange(CDC_spectra + theme(legend.position="none"), Bi_plot+ theme(legend.position="none"), nrow=1, widths = unit(c(10,9), "cm"), heights = unit(rep(10, 1), "cm"))
p4<-grid.arrange(p3,Kdistrib,nrow=2,heights = unit(c(10,7), "cm"), widths = unit(c(15), "cm"))
bipl %>% head
# are the CDC values the same amongst all three groups?
kruskal.test(bipl)
# Are the cdc values smaller in Ruthia than FL?
wilcox.test(bipl$Ruthia,bipl$FL,alternative = 'less',paired=T) # respective of each gene
# Are the cdc values smaller in RutGigashia than FL?
wilcox.test(bipl$Gigas,bipl$FL,alternative = 'less',paired=T) # respective of each gene
# Are the cdc values smaller in Gigas than Ruthia?
wilcox.test(bipl$Gigas,bipl$Ruthia,alternative = 'less',paired=T) # respective of each gene
##### cdc spectra per genome ########
cdc_spectra=subset(df,P.CDC.<0.05 & ispseudo==0)
df1=subset(relax2,comp %in% c('GivsFL','RuvsFL') & pval<0.05)
df1=as.data.frame(dcast(df1, gene~comp,value.var='k'))
wilcox.test(df1$GivsFL,df1$RuvsFL,alternative = 'less') # overall
wilcox.test(df1$GivsFL,df1$RuvsFL,alternative = 'less',paired=T) # respective of each gene
wilcox.test(df1$GivsFL,df1$RuvsFL,alternative = 'less',paired=T) # respective of each gene
